---
import type { GetStaticPaths, Page } from "astro"
import PostPage from "../components/PostPage.astro"
import Pagination from "../components/control/Pagination.astro"
import { PAGE_SIZE } from "../constants/constants"
import MainGridLayout from "../layouts/MainGridLayout.astro"
import { getSortedPosts } from "../utils/content-utils"
import type { CollectionEntry } from "astro:content"

export const getStaticPaths = (async ({ paginate }) => {
  return paginate(await getSortedPosts(), { pageSize: PAGE_SIZE })
}) satisfies GetStaticPaths

type Props = Readonly<{
  page: Page<CollectionEntry<"posts">>
}>

const { page } = Astro.props
---

<MainGridLayout>
  <PostPage {page} />
  <Pagination
    class="mx-auto onload-animation"
    {page}
    style={`animation-delay: calc(var(--content-delay) + ${page.data.length * 50}ms)`}
  />
</MainGridLayout>
