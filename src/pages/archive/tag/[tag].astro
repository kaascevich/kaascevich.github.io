---
import type { GetStaticPathsResult } from 'astro'

import * as R from 'remeda'
import ArchivePanel from '$/components/archive/ArchivePanel.astro'
import strings from '$/config/strings'
import MainGridLayout from '$/layouts/MainGridLayout.astro'
import { getTagCounts } from '$/utils/content'

export async function getStaticPaths() {
  return R.pipe(
    await getTagCounts(),
    (x) => Array.from(x),
    R.map(([tag]) => ({ params: { tag } })),
  ) satisfies GetStaticPathsResult
}

const { tag } = Astro.params
---

<MainGridLayout title={strings.nav.archive}>
  <ArchivePanel filter={{ type: 'tag', tag }} />
</MainGridLayout>
