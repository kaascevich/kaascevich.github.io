---
import { formatDate } from "$/utils/dates"
import { Icon } from "astro-icon/components"
import { i18n } from "$/i18n/translation"
import I18nKey from "$/i18n/i18nKey"
import { url } from "$/utils/urls"

type Props = Readonly<{
  class: string
  published: Date
  updated?: Date | undefined
  tags: readonly string[]
  category: string | undefined
  hideTagsForMobile?: boolean | undefined
  hideUpdateDate?: boolean | undefined
}>

const {
  class: className,
  published,
  updated,
  tags,
  category,
  hideTagsForMobile = false,
  hideUpdateDate = false,
} = Astro.props
---

<div
  class:list={[
    "flex flex-wrap text-neutral-500 dark:text-neutral-400 items-center gap-4 gap-x-4 gap-y-2",
    className,
  ]}
>
  <!-- publish date -->
  <div class="flex items-center">
    <div class="meta-icon">
      <Icon name="tabler:calendar-plus" class="text-xl" />
    </div>
    <span class="text-50 text-sm font-medium">
      {formatDate(published)}
    </span>
  </div>

  <!-- update date -->
  {
    !hideUpdateDate &&
      updated !== undefined &&
      updated.getTime() !== published.getTime() && (
        <div class="flex items-center">
          <div class="meta-icon">
            <Icon name="tabler:calendar-cog" class="text-xl" />
          </div>
          <span class="text-50 text-sm font-medium">{formatDate(updated)}</span>
        </div>
      )
  }

  <!-- categories -->
  <div class="flex items-center">
    <div class="meta-icon">
      <Icon name="tabler:category" class="text-xl" />
    </div>
    <div class="flex flex-row flex-nowrap items-center">
      <a
        href={url(`/archive/category/${category ?? "uncategorized"}/`)}
        aria-label={`View all posts in the ${category} category`}
        class="link-lg transition text-50 text-sm font-medium hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"
      >
        {category ?? i18n(I18nKey.uncategorized)}
      </a>
    </div>
  </div>

  <!-- tags -->
  <div
    class:list={[
      "items-center",
      { flex: !hideTagsForMobile, "hidden md:flex": hideTagsForMobile },
    ]}
  >
    <div class="meta-icon">
      <Icon name="tabler:hash" class="text-xl" />
    </div>
    <div class="flex flex-row flex-nowrap items-center">
      {
        tags.length > 0 ?
          tags.map((tag, i) => (
            <>
              <div
                class:list={[
                  { hidden: i === 0 },
                  "mx-1.5 text-[var(--meta-divider)] text-sm",
                ]}
              >
                /
              </div>
              <a
                href={url(`/archive/tag/${tag}/`)}
                aria-label={`View all posts with the ${tag} tag`}
                class="link-lg transition text-50 text-sm font-medium hover:text-[var(--primary)] dark:hover:text-[var(--primary)] whitespace-nowrap"
              >
                {tag}
              </a>
            </>
          ))
        : <div class="transition text-50 text-sm font-medium">
            {i18n(I18nKey.noTags)}
          </div>
      }
    </div>
  </div>
</div>
