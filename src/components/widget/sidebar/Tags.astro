---
import WidgetLayout from '$/components/widget/WidgetLayout.astro'
import ButtonTag from '$/components/control/ButtonTag.astro'
import { getTagCounts } from '$/utils/content'
import strings from '$/config/strings'

const tags = Array.from(await getTagCounts())

const COLLAPSED_HEIGHT = '7.5rem'
const COLLAPSE_THRESHOLD = 20

interface Props {
  class?: string
}

const { class: className } = Astro.props
---

<WidgetLayout
  name={strings.tags.label}
  id='tags'
  isCollapsed={tags.length >= COLLAPSE_THRESHOLD}
  collapsedHeight={COLLAPSED_HEIGHT}
  class={className}
>
  <ul>
    {
      tags.map(([tag]) => (
        <ButtonTag href={`/archive/tag/${tag}/`} label={strings.alts.tag(tag)}>
          {tag}
        </ButtonTag>
      ))
    }
  </ul>
</WidgetLayout>

<style lang='scss'>
  @use '$/styles/main';
  @use '$/styles/theme' as *;
  @use '$/styles/utils' as *;
  @use '$/styles/variants' as *;

  ul {
    display: block flex;

    flex-wrap: wrap;

    gap: spacing(2);
  }
</style>
