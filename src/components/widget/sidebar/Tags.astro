---
import WidgetLayout from '$/components/widget/WidgetLayout.astro'
import ButtonTag from '$/components/control/ButtonTag.astro'
import { getTagCounts } from '$/utils/content'
import strings from '$/config/strings'

const tags = Array.from(await getTagCounts())

const COLLAPSED_HEIGHT = '7.5rem'
const COLLAPSE_THRESHOLD = 20

const isCollapsed = tags.length >= COLLAPSE_THRESHOLD

interface Props {
  class?: string
  style?: string
}

const { class: className, style } = Astro.props
---

<WidgetLayout
  name={strings.tags.label}
  id="tags"
  {isCollapsed}
  collapsedHeight={COLLAPSED_HEIGHT}
  class={className}
  {style}
>
  <ul class="flex gap-2 flex-wrap">
    {
      tags.map(([tag]) => (
        <ButtonTag href={`/archive/tag/${tag}/`} label={strings.alts.tag(tag)}>
          {tag}
        </ButtonTag>
      ))
    }
  </ul>
</WidgetLayout>
