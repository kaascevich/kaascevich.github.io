---
import WidgetLayout from '$/components/widget/WidgetLayout.astro'
import ButtonLink from '$/components/control/ButtonLink.astro'
import { getCategoryCounts } from '$/utils/content'
import strings from '$/config/strings'

const categories = Array.from(await getCategoryCounts())

const COLLAPSED_HEIGHT = '7.5rem'
const COLLAPSE_THRESHOLD = 5

interface Props {
  class?: string
}

const { class: className } = Astro.props
---

<WidgetLayout
  name={strings.categories.label}
  id='categories'
  isCollapsed={categories.length >= COLLAPSE_THRESHOLD}
  collapsedHeight={COLLAPSED_HEIGHT}
  class={className}
>
  {
    categories.map(([category, count]) => (
      <ButtonLink
        url={`/archive/category/${category}/`}
        badge={String(count)}
        label={strings.alts.category(category)}
      >
        {category}
      </ButtonLink>
    ))
  }
</WidgetLayout>
