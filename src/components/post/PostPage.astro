---
import type { Page } from 'astro'
import type { Post } from '$/types/content'

import * as R from 'remeda'
import { getPostUrlByID } from '$/utils/urls'
import PostCard from '$/components/post/PostCard.astro'

interface Props {
  page: Page<Post>
}
const { page } = Astro.props

const DELAY_INTERVAL = 50
const entriesWithDelays = R.pipe(
  page.data,
  R.map((entry, index) => [index * DELAY_INTERVAL, entry] as const),
)
---

<ol>
  {
    entriesWithDelays.map(([delay, entry]) => (
      <PostCard
        {entry}
        url={getPostUrlByID(entry.id)}
        class="onload-animation"
        style={`animation-delay: calc(var(--content-delay) + ${delay}ms);`}
      />
    ))
  }
</ol>

<style lang="scss">
  @use '$/styles/theme' as *;
  @use '$/styles/utils' as *;
  @use '$/styles/variants';

  ol {
    @include transition();
    display: flex;
    flex-direction: column;
    border-radius: $radius-xl2;
    background-color: var(--card-bg);
    @include padding-y(spacing(1));
    margin-bottom: spacing(4);

    @include variants.md {
      @include padding-y(0);
      gap: spacing(4);
      background-color: transparent;
    }
  }
</style>
