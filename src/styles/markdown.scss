@use "main";
@use "theme" as *;
@use "utils" as *;
@use "variants";

.custom-md {
  word-break: break-word;
  h1 {
    @include font-size($text-xl3);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    .anchor {
      opacity: 0%;
      margin: spacing(-0.5) {
        left: 0.2ch !important;
      }
      padding: spacing(0.5) !important;
      user-select: none;
      text-decoration-line: none !important;

      .anchor-icon {
        @include margin-x(0.45ch !important);
      }
    }

    &:hover {
      .anchor {
        opacity: 100%;
      }
    }
  }

  :any-link:not(.no-styling) {
    @extend .link;
    position: relative;
    background-image: none;
    color: var(--primary);
    font-weight: $font-weight-medium;
    text-underline-offset: 4px;
    text-decoration: {
      line: underline;
      color: var(--link-underline);
      style: dashed;
      thickness: 1px;
    }

    &:hover,
    &:active {
      text-decoration-color: transparent;
    }

    &[data-footnote-ref] {
      margin-left: spacing(-0.5);
      text-decoration-line: none;
    }
  }

  code {
    border-radius: $radius-md;
    background-color: var(--inline-code-bg);
    padding: spacing(1);
    overflow: hidden;
    color: var(--inline-code-color);

    font-family:
      "Monaspace Radon",
      ui-monospace,
      SFMono-Regular,
      Menlo,
      Monaco,
      Consolas,
      Liberation Mono,
      Courier New,
      monospace;
    font-feature-settings:
      "calt", "liga", "ss01", "ss02", "ss03", "ss04", "ss05", "ss06", "ss07",
      "ss08", "ss09";

    @include before(none);
    @include after(none);

    // line numbers
    counter-reset: line;
    span.line {
      @include before(counter(line)) {
        display: inline-block;

        counter-increment: line;
        margin-right: spacing(4);
        width: spacing(4);
        color: white(25%);
        direction: rtl;
      }
      &:last-child:empty,
      &:last-child:has(> span:empty:only-child) {
        display: none;
      }
    }
  }

  :not(pre) code {
    position: relative;
    bottom: spacing(0.2);
  }

  pre {
    border-radius: $radius-xl;
    background-color: var(--codeblock-bg) !important;
    @include padding-x(spacing(5));

    code {
      background-color: transparent;
      color: inherit;
      @include font-size($text-sm);
      padding: 0;

      ::selection {
        background-color: var(--codeblock-selection);
      }
    }
  }

  ul,
  ol {
    li::marker {
      color: var(--primary);
    }
  }

  blockquote {
    position: relative;
    border-color: transparent;
    font-style: normal;
    font-weight: inherit;

    @include before {
      display: block;
      position: absolute;
      left: spacing(-1);
      @include transition();
      border-radius: 9999px;
      background-color: var(--btn-regular-bg);
      width: spacing(1);
      height: 100%;
    }

    // remove the double quotes from default styles
    p {
      @include before(none);
      @include after(none);
    }
  }
}
